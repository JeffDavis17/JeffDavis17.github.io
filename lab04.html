<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>ArcGIS DevLabs: JavaScript Starter App - Jeff Davis</title>
  <style>
    html, body, #viewDiv {
      padding: 0; 
      margin: 0;
      height: 100%;
      width: 100%;
    }
    #search{ display:block; position:absolute; z-index:3; top:20px; left:75px}
  </style>
  
  <link rel="stylesheet" href="https://js.arcgis.com/4.10/esri/css/main.css">
  <script src="https://js.arcgis.com/4.10/"></script>
  
  <script>  
    require([
      "esri/Map",
      "esri/views/MapView",
      "esri/layers/FeatureLayer",
      "dojo/domReady!"
    ], function(Map, MapView,FeatureLayer) {
      var map = new Map({
        basemap: "topo-vector"
      });
      
      var view = new MapView({
        container: "viewDiv",
        map: map,
        center: [-118.71511,34.09042],
        zoom: 11
      });
      
      //Trailheads point feature layer
      var featureLayer = new FeatureLayer({
        url: "https://services3.arcgis.com/GVgbJbqm8hXASVYi/arcgis/rest/services/Trailheads/FeatureServer"
      });      
          
      // Parks
      var parks = new FeatureLayer({
        url: "https://services3.arcgis.com/GVgbJbqm8hXASVYi/arcgis/rest/services/Parks_and_Open_Space/FeatureServer"
      });
      
      // Trails Layer
      var trail = new FeatureLayer({
        url: "https://services3.arcgis.com/GVgbJbqm8hXASVYi/arcgis/rest/services/Trails/FeatureServer", definitionExpression: "ELEV_GAIN < 250"
      });
      map.add(parks);
      map.add(trail);
      map.add(featureLayer);
    });
    
    // Widget
    dojo.require("esri.dijit.Geocoder", function(){
      var Geocoder = new esri.dijit.Geocoder({
        autoComplete: true, map:map},dojo.byId("search"))});   
    Geocoder.startup();

    dojo.connect(Geocoder, "onSelect", function(result){
      map.graphics.clear();
      var point = result.feature.geometry;
      var symbol = new esri.symbol.SimpleMarkerSymbol().setStyle(
      esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE).setColor(
      new dojo.Color([255,0,0,0.5]));
      var graphic = new esri.Graphic(point, symbol);
      map.graphics.add(graphic);
      map.infoWindow.setTitle("Search Result");
      map.infoWindow.setContent(result.name);
      map.infoWindow.show(result.feature.geometry);
    });
    
    var Geocoder = new esri.dijit.Geocoder({
    arcgisGeocoder: {
    placeholder: "Find a place"
    },
    map: map
    }, dojo.byId("search"));
/*
    .spotlight {
    z-index:-1;
    position:absolute;
    left:50%;
    top:50%;
    border-radius:50%;
    opacity:0;
    box-shadow:
    inset rgba(0,0,0,0.25) 0px 0px 20px 20px,
    rgba(0,0,0,0.25) 0px 0px 0px 1000px;
    transition:all 1000ms;
    -moz-transition:all 1000ms;
    -webkit-transition:all 1000ms;
    }
.spotlight-active {
z-index:2;
opacity:1;
}
var html = "<div id='spotlight' class='spotlight'></div>"
dojo.place(html, dojo.byId("map_container"), "first");
  
var spotlight = dojo.connect(map, 'onExtentChange', function(){
var geom = esri.geometry.toScreenGeometry(map.extent,
map.width, map.height, result.extent);
var width = geom.xmax - geom.xmin;
var height = geom.ymin - geom.ymax;
var max = height;
if(width > height){
max = width;
}
var margin = '-' + Math.floor(max/2) + 'px 0 0 -' +
Math.floor(max/2) + 'px';
var pt = result.feature.geometry;
var sms = new esri.symbol.SimpleMarkerSymbol().setStyle(
esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE).setColor(
new dojo.Color([255,0,0,0.5]));
var graphic = new esri.Graphic(pt,sms,null,null);
map.graphics.add(graphic);
dojo.query('.spotlight').addClass('spotlight-active').style({
width: max + 'px',
height: max + 'px',
margin: margin
});
dojo.disconnect(spotlight);
});

function removeSpotlight(){
dojo.query('.spotlight').removeClass('spotlight-active');
map.graphics.clear();
}
dojo.connect(Geocoder, 'onClear', function(){
removeSpotlight();
});
*/
  </script>
</head>
<body>
  <div id="viewDiv"></div>
  <body class="soria"> <div id="search"></div> <div id="map"></div> </body
</body>
</html>